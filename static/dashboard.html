<!DOCTYPE html><html><head><title>Dashboard</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e);min-height:100vh;color:#fff}nav{padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,0.1)}.logo{font-size:1.5rem;font-weight:700;color:#4f46e5}.btn{padding:0.5rem 1rem;border-radius:8px;border:none;cursor:pointer}.btn-primary{background:#4f46e5;color:#fff}.btn-danger{background:#ef4444;color:#fff}.btn-secondary{background:rgba(255,255,255,0.1);color:#fff}.container{max-width:1200px;margin:0 auto;padding:2rem}.grid{display:grid;grid-template-columns:350px 1fr;gap:2rem}.card{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:1.5rem}.card h2{margin-bottom:1rem}.form-group{margin-bottom:1rem}label{display:block;margin-bottom:0.4rem;color:#94a3b8}input,select{width:100%;padding:0.7rem;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:#fff}select option{background:#1a1a2e}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.alert{padding:0.8rem;border-radius:8px;margin-bottom:1rem;display:none}.alert-success{background:rgba(34,197,94,0.1);border:1px solid #22c55e;color:#22c55e}.alert-error{background:rgba(239,68,68,0.1);border:1px solid #ef4444;color:#ef4444}.alert.show{display:block}.result-box{background:rgba(79,70,229,0.1);border:1px solid #4f46e5;border-radius:8px;padding:1rem;text-align:center;margin-bottom:1rem}.result-box .value{font-size:2rem;font-weight:700;color:#4f46e5}table{width:100%;border-collapse:collapse}th,td{padding:0.8rem;text-align:left;border-bottom:1px solid rgba(255,255,255,0.1)}th{color:#94a3b8}.actions{display:flex;gap:0.5rem}.empty{text-align:center;padding:2rem;color:#94a3b8}@media(max-width:768px){.grid{grid-template-columns:1fr}}</style></head><body><nav><div class="logo">BREAD Calculator</div><div><span id="userInfo" style="color:#94a3b8;margin-right:1rem"></span><button class="btn btn-secondary" onclick="logout()">Logout</button></div></nav><div class="container"><div class="grid"><div class="card"><h2>Add Calculation</h2><div id="addAlert" class="alert"></div><form id="addForm"><div class="form-group"><label>Operation</label><select id="operation"><option value="add">Add (+)</option><option value="subtract">Subtract (-)</option><option value="multiply">Multiply (x)</option><option value="divide">Divide (/)</option></select></div><div class="form-row"><div class="form-group"><label>Operand A</label><input type="number" id="operandA" step="any" value="0"></div><div class="form-group"><label>Operand B</label><input type="number" id="operandB" step="any" value="0"></div></div><div class="result-box"><div style="color:#94a3b8">Result</div><div class="value" id="preview">-</div></div><button type="submit" class="btn btn-primary" style="width:100%">Add Calculation</button></form></div><div class="card"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem"><h2 style="margin:0">Calculations</h2><button class="btn btn-secondary" onclick="loadCalcs()">Refresh</button></div><div id="calcList"><div class="empty">Loading...</div></div></div></div></div><script>const token=localStorage.getItem("token");const headers={"Content-Type":"application/json"};if(token)headers["Authorization"]="Bearer "+token;async function loadUser(){if(!token)return;try{const res=await fetch("/api/me",{headers});if(res.ok){const user=await res.json();document.getElementById("userInfo").textContent=user.email}}catch(e){}}function updatePreview(){const op=document.getElementById("operation").value;const a=parseFloat(document.getElementById("operandA").value)||0;const b=parseFloat(document.getElementById("operandB").value)||0;let r;if(op==="add")r=a+b;else if(op==="subtract")r=a-b;else if(op==="multiply")r=a*b;else if(op==="divide")r=b!==0?a/b:"Error";document.getElementById("preview").textContent=typeof r==="number"?r.toFixed(4):r}document.getElementById("operation").addEventListener("change",updatePreview);document.getElementById("operandA").addEventListener("input",updatePreview);document.getElementById("operandB").addEventListener("input",updatePreview);async function loadCalcs(){try{const res=await fetch("/api/calculations",{headers});const data=await res.json();const list=document.getElementById("calcList");if(data.calculations.length===0){list.innerHTML="<div class=\"empty\">No calculations yet</div>";return}const symbols={add:"+",subtract:"-",multiply:"x",divide:"/"};list.innerHTML="<table><thead><tr><th>ID</th><th>Calculation</th><th>Result</th><th>Actions</th></tr></thead><tbody>"+data.calculations.map(c=>"<tr><td>#"+c.id+"</td><td>"+c.operand_a+" "+symbols[c.operation]+" "+c.operand_b+"</td><td><strong>"+c.result+"</strong></td><td class=\"actions\"><button class=\"btn btn-secondary\" onclick=\"viewCalc("+c.id+")\">View</button><button class=\"btn btn-danger\" onclick=\"deleteCalc("+c.id+")\">Delete</button></td></tr>").join("")+"</tbody></table>"}catch(e){document.getElementById("calcList").innerHTML="<div class=\"empty\">Error loading</div>"}}document.getElementById("addForm").addEventListener("submit",async e=>{e.preventDefault();const alert=document.getElementById("addAlert");const body={operation:document.getElementById("operation").value,operand_a:parseFloat(document.getElementById("operandA").value),operand_b:parseFloat(document.getElementById("operandB").value)};if(body.operation==="divide"&&body.operand_b===0){alert.textContent="Cannot divide by zero";alert.className="alert alert-error show";return}try{const res=await fetch("/api/calculations",{method:"POST",headers,body:JSON.stringify(body)});if(res.ok){alert.textContent="Added!";alert.className="alert alert-success show";loadCalcs()}else{const data=await res.json();alert.textContent=data.detail||"Error";alert.className="alert alert-error show"}}catch(e){alert.textContent="Network error";alert.className="alert alert-error show"}setTimeout(()=>alert.classList.remove("show"),3000)});async function viewCalc(id){const res=await fetch("/api/calculations/"+id,{headers});const c=await res.json();const symbols={add:"+",subtract:"-",multiply:"x",divide:"/"};alert("Calculation #"+c.id+"\n\n"+c.operand_a+" "+symbols[c.operation]+" "+c.operand_b+" = "+c.result)}async function deleteCalc(id){if(!confirm("Delete this calculation?"))return;await fetch("/api/calculations/"+id,{method:"DELETE",headers});loadCalcs()}function logout(){localStorage.removeItem("token");window.location.href="/login"}loadUser();loadCalcs()</script></body></html>
